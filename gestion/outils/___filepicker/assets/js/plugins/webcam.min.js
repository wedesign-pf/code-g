+function(t){var e=function(o,a){this.filePicker=o,this.container=a.container,this.options=t.extend({},e.defaults,a),this.init()};e.defaults={swf:"assets/js/plugins/webcam.swf",swfSize:[568,423],modal:!1},e.prototype.init=function(){navigator.getUserMedia=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia,this.options.modal=this.container.hasClass("modal"),this.options.camera||(this.options.camera=this.container.find(".camera")),this.options.closeButton||(this.options.closeButton=this.container.find(".close-webcam")),this.options.snapButton||(this.options.snapButton=this.container.find(".snap")),this.options.openButton.on("click",t.proxy(this.open,this)),this.options.closeButton.on("click",t.proxy(this.close,this)),this.options.snapButton.on("click",t.proxy(this.snap,this)).prop("disabled",!0),this.options.modal&&this.container.on("shown.bs.modal",t.proxy(this.show,this)).on("hidden.bs.modal",t.proxy(this.close,this))},e.prototype.open=function(){this.options.modal?this.container.modal("show"):(this.container.show(),this.show())},e.prototype.close=function(){this.options.modal?this.container.modal("hide"):this.container.hide(),this._stream&&this._stream.stop(),this.options.camera.html("")},e.prototype.show=function(){var e,o=this;return navigator.getUserMedia?(this.options.camera.html(e=t("<video autoplay></video>")),void navigator.getUserMedia({video:!0},function(t){e.attr("src",window.URL.createObjectURL(o._stream=t)),o.options.camera.show(),o.options.snapButton.prop("disabled",!1),o._callback=function(){var t=document.createElement("canvas"),o=t.getContext("2d");return t.width=e[0].videoWidth,t.height=e[0].videoHeight,o.drawImage(e[0],0,0),t.toDataURL("image/jpeg")}},function(){alert("Could not access webcam."),o.close()})):(this.options.camera.html(Webcam.getHtml(this.options.swf,this.options.swfSize)).show(),void(Webcam.loaded=function(){o.options.snapButton.prop("disabled",!1),o._callback=function(){return Webcam.snap()}}))},e.prototype.snap=function(){if(!window.Blob)return alert("Please upgrade your browser.");var e=this._callback();if(!e.match(/^data\:image\/(\w+)/))return alert("Cannot locate image format in Data URI.");var o=e.replace(/^data\:image\/\w+\;base64\,/,""),a=new Blob([this.base64DecToArr(o)],{type:"image/png"});a.name=(new Date).getTime()+".png",a.autoUpload=!0,this.filePicker.onAdd(t.Event,[a]),this.close()},e.prototype.b64ToUint6=function(t){return t>64&&91>t?t-65:t>96&&123>t?t-71:t>47&&58>t?t+4:43===t?62:47===t?63:0},e.prototype.base64DecToArr=function(t,e){for(var o,a,i=t.replace(/[^A-Za-z0-9\+\/]/g,""),n=i.length,s=e?Math.ceil((3*n+1>>2)/e)*e:3*n+1>>2,r=new Uint8Array(s),c=0,l=0,h=0;n>h;h++)if(a=3&h,c|=this.b64ToUint6(i.charCodeAt(h))<<18-6*a,3===a||n-h===1){for(o=0;3>o&&s>l;o++,l++)r[l]=c>>>(16>>>o&24)&255;c=0}return r},window.FilepickerWebcam=function(o,a){return o instanceof t&&(o=o.filePicker()),new e(o,a)}}(jQuery),window.Webcam={isLoaded:!1,loaded:null,complete:null,error:null,getHtml:function(t,e){return'<object id="webcam_movie_obj" type="application/x-shockwave-flash" width="'+e[0]+'" height="'+e[1]+'"><param name="allowScriptAccess" value="always"/><param name="allowFullScreen" value="false"/><param name="movie" value="'+t+'"/><param name="wmode" value="transparent"/><param name="flashvars" value="width='+e[0]+"&height="+e[1]+"&dest_width="+1.5*e[0]+"&dest_height="+1.5*e[1]+'&image_format=jpeg&jpeg_quality=100&force_flash=false"></object>'},snap:function(){if(!this.isLoaded)return alert("JPEGCam ERROR: Movie is not loaded yet.");var t=document.getElementById("webcam_movie_obj"),e="";t||alert("JPEGCam ERROR: Cannot locate movie #webcam_movie_obj in DOM");try{e="data:image/jpeg;base64,"+t._snap()}catch(o){}return e},flashNotify:function(t,e){switch(t){case"flashLoadComplete":this.isLoaded=!0;break;case"cameraLive":this.loaded();break;case"error":this.error(e)}}};